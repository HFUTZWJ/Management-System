<!DOCTYPE html>
<html lang="en">
<head>
    <script src="./js/jquery-1.8.3.min.js"></script>
    <script type="text/javascript"></script>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <a onclick="requestData()">测试</a>
    <table id="tab">
    <thead>
    <tr>
        <td>CId</td>
        <td>CName</td>
    </tr>
    </thead>
    <tbody id='tbody1'>

    </tbody>
    </table>
    <script>
        function requestData(){
            $.ajax({
                url: "/find",
                type: "post",
                dataType: "json",
                success: function(data){
                    showData(data);
                },
                error: function(msg){
                    alert(msg);
                }
            });
        };
        //展示数据
        function showData(data) {
            var str = "";//定义用于拼接的字符串
            for (var i = 0; i < data.length; i++) {
                //拼接表格的行和列
                //str = "<tr><td>" + data[i].id + "</td><td>" + data[i].name + "</td></tr>";
                //追加到table中
                //$("#tab").append(str);
                var tr = document.createElement('tr');
                var tcargo_id = document.createElement('td');
                var tcargo_name = document.createElement('td');
                var tcargo_del = document.createElement('td');
                tcargo_id.innerHTML = data[i].id;
                tcargo_name.innerHTML = data[i].name;
                tcargo_del.innerHTML = "删除";
                tcargo_del.id = data[i].id;
                tcargo_del.setAttribute("onclick", "del()");
                tr.appendChild(tcargo_id);
                tr.appendChild(tcargo_name);
                tr.appendChild(tcargo_del);
                var tbody = document.getElementById('tbody1');
                tbody.appendChild(tr);
            }
        }
        function del() {
            // 获取当前被点击的标签的id /spend 1.5h hhhhh
            var cargo_id = parseInt(window.event.srcElement.id);
            var jsonob = {
                "cargo_id": cargo_id
            };
            var url = "/delete";
            $.ajax({
                url: url,
                type: "get",
                dataType: "json",
                data: jsonob,
                async: false,
                success: function (data) {
                    var obj = jQuery.parseJSON(data);
                    alert("删除成功");
                    window.location.href = "./allcargo.html";
                },
                error: function(msg) {
                    alert(msg);
                }
            });
        }
    </script>
</body>

</html>